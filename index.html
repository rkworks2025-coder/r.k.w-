<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>タイヤ点検ログ</title>
<style>
  :root{
    --bg:#0f1115;
    --card:#171a21;
    --ink:#e8eaf0;
    --muted:#a8b0c0;
    --accent:#5dd4fb;
    --ok:#60d394;
    --warn:#ffcc66;
    --danger:#ff6b6b;
    --line:#262b36;
    --field:#0f1115;
  }
  *{box-sizing:border-box;-webkit-tap-highlight-color: transparent;}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family: -apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN","Meiryo",sans-serif;}
  header{
    position:sticky;top:0;z-index:10;
    background:linear-gradient(180deg,rgba(15,17,21,.98),rgba(15,17,21,.96) 60%,rgba(15,17,21,.7) 100%);
    backdrop-filter: saturate(140%) blur(8px);
    border-bottom:1px solid var(--line);
  }
  .bar{display:flex;align-items:center;gap:10px;padding:14px 16px;}
  .title{font-weight:700;font-size:18px;letter-spacing:.3px;}
  .seg{margin-left:auto;display:flex;border:1px solid var(--line);border-radius:12px;overflow:hidden;}
  .seg button{background:transparent;color:var(--muted);border:0;padding:8px 12px;font-size:13px}
  .seg button.active{background:var(--card);color:var(--ink);}
  main{padding:16px; padding-bottom:96px;}
  .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:14px;margin-bottom:14px;}

  .group{display:grid;grid-template-columns: 120px repeat(4, minmax(4.5em, 1fr));gap:10px;align-items:center;}
  .group .glabel{font-size:12px;color:var(--muted);}
  .group .hdr{font-size:11px;color:var(--muted);text-align:center}
  .group input{width:100%;background:var(--field);color:var(--ink);border:1px solid var(--line);border-radius:10px;padding:10px 10px;font-size:16px}
  .group input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(93,212,251,.12)}
  .group .mini{font-size:12px;color:var(--muted);grid-column:1 / -1;margin-top:4px}
  .quad-input{width:4em;text-align:center;}

  .twocol{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media (max-width:560px){
    .group{grid-template-columns: 56px repeat(4, 4em); gap:2px;}
    .group input{padding:8px 8px;font-size:16px}
    .twocol{grid-template-columns:1fr;}
  }

  .actions{display:flex;gap:10px;flex-wrap:wrap}
  button.primary{background:#555;border:1px solid #555;color:white;border-radius:12px;padding:12px 14px;font-weight:700;font-size:16px;}
  button.ghost{background:#444;border:1px solid #555;color:#fff;border-radius:12px;padding:12px 14px;font-weight:600}
  .fab{
    position:fixed;bottom:18px;left:16px;right:16px;display:flex;justify-content:space-between;align-items:center;
    padding:14px 16px;border-radius:16px;border:1px solid #555;box-shadow: 0 10px 30px rgba(0,0,0,.35);
    background:#333;color:#fff;
  }
  .fab .right{display:flex;gap:8px}

  table{width:100%;border-collapse:collapse}
  th,td{border-bottom:1px solid var(--line);padding:10px 6px;text-align:left;font-size:13px;vertical-align:top}
  th{color:var(--muted);font-weight:600}
  .muted{color:var(--muted)}
  .danger{color:var(--danger)}
  .warn{color:var(--warn)}
  .mono{font-family: ui-monospace, SFMono-Regular, Menlo, monospace;}
  .footer-space{height:82px}
  .section-title{font-weight:700;margin:8px 0 10px 0}
  .nowrap{white-space:nowrap}
  .small{font-size:12px}
  .menu{position:fixed;z-index:20;background:var(--card);border:1px solid var(--line);border-radius:12px;overflow:hidden;min-width:160px;box-shadow: 0 10px 30px rgba(0,0,0,.4);}
  .menu button{display:block;width:100%;text-align:left;background:transparent;border:0;color:var(--ink);padding:12px 14px}
  .menu button:hover{background:#1f2430}
</style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="title">タイヤ点検ログ</div>
      <div class="seg">
        <button id="tab-input" class="active">入力</button>
        <button id="tab-preview">結果</button>
        <button id="tab-list">一覧</button>
        <button id="tab-spec">規定圧</button>
        <button id="tab-tools">ツール</button>
      </div>
    </div>
  </header>

  <main>
    <section id="view-input">
      <div class="card">
        <div class="twocol">
          <div>
            <div class="section-title">車両情報</div>
            <label class="small muted">ステーション名</label>
            <input id="station" placeholder="例: 相模原第1" inputmode="text" autocomplete="on">
          </div>
          <div>
            <label class="small muted">車種</label>
            <input id="model" placeholder="例: ワゴンR MH23S" list="model-list" autocomplete="on">
            <datalist id="model-list"></datalist>
            <div class="small muted">既存の車種なら規定圧が自動入力されます。</div>
          </div>
        </div>
        <div style="margin-top:10px">
          <label class="small muted">車番</label>
          <input id="carno" placeholder="例: 相模 500 あ 12-34" inputmode="text" autocomplete="on">
        </div>
      </div>

      <div class="card">
        <div class="section-title">施錠/解錠時刻</div>
        <div class="twocol">
          <div>
            <label class="small muted">解錠時刻</label>
            <input id="unlock" type="time" inputmode="numeric">
          </div>
          <div>
            <label class="small muted">施錠時刻</label>
            <input id="lock" type="time" inputmode="numeric">
          </div>
        </div>
      </div>

      <div class="card">
        <div class="section-title">残溝 (mm)</div>
        <div class="group">
          <div class="glabel">位置</div>
          <div class="hdr">RF</div><div class="hdr">LF</div><div class="hdr">LR</div><div class="hdr">RR</div>
          <div class="glabel">数値</div>
          <input id="td_rf" class="quad-input" type="number" step="0.1" inputmode="decimal">
          <input id="td_lf" class="quad-input" type="number" step="0.1" inputmode="decimal">
          <input id="td_lr" class="quad-input" type="number" step="0.1" inputmode="decimal">
          <input id="td_rr" class="quad-input" type="number" step="0.1" inputmode="decimal">
        </div>
      </div>

      <div class="card">
        <div class="section-title">空気圧 規定値 (kPa) <span class="small muted">車種ごとに保存</span></div>
        <div class="group">
          <div class="glabel">位置</div>
          <div class="hdr">RF</div><div class="hdr">LF</div><div class="hdr">LR</div><div class="hdr">RR</div>
          <div class="glabel">数値</div>
          <input id="spec_rf" class="quad-input" type="number" inputmode="numeric">
          <input id="spec_lf" class="quad-input" type="number" inputmode="numeric">
          <input id="spec_lr" class="quad-input" type="number" inputmode="numeric">
          <input id="spec_rr" class="quad-input" type="number" inputmode="numeric">
          <div class="mini">※「この車種の規定圧を保存」で次回以降は自動入力</div>
        </div>
        <div class="actions" style="margin-top:10px">
          <button class="ghost" id="btn-save-spec">この車種の規定圧を保存</button>
        </div>
      </div>

      <div class="card">
        <div class="section-title">空気圧 調整前 (kPa)</div>
        <div class="group">
          <div class="glabel">位置</div>
          <div class="hdr">RF</div><div class="hdr">LF</div><div class="hdr">LR</div><div class="hdr">RR</div>
          <div class="glabel">数値</div>
          <input id="pre_rf" class="quad-input" type="number" inputmode="numeric">
          <input id="pre_lf" class="quad-input" type="number" inputmode="numeric">
          <input id="pre_lr" class="quad-input" type="number" inputmode="numeric">
          <input id="pre_rr" class="quad-input" type="number" inputmode="numeric">
        </div>
      </div>

      <div class="card">
        <div class="section-title">空気圧 調整後 (kPa)</div>
        <div class="group">
          <div class="glabel">位置</div>
          <div class="hdr">RF</div><div class="hdr">LF</div><div class="hdr">LR</div><div class="hdr">RR</div>
          <div class="glabel">数値</div>
          <input id="post_rf" class="quad-input" type="number" inputmode="numeric">
          <input id="post_lf" class="quad-input" type="number" inputmode="numeric">
          <input id="post_lr" class="quad-input" type="number" inputmode="numeric">
          <input id="post_rr" class="quad-input" type="number" inputmode="numeric">
        </div>
      </div>

      <div class="card">
        <div class="section-title">製造年週 (各タイヤ 4桁)</div>
        <div class="group">
          <div class="glabel">位置</div>
          <div class="hdr">RF</div><div class="hdr">LF</div><div class="hdr">LR</div><div class="hdr">RR</div>
          <div class="glabel">数値</div>
          <input id="yw_rf" class="quad-input mono" maxlength="4" inputmode="numeric">
          <input id="yw_lf" class="quad-input mono" maxlength="4" inputmode="numeric">
          <input id="yw_lr" class="quad-input mono" maxlength="4" inputmode="numeric">
          <input id="yw_rr" class="quad-input mono" maxlength="4" inputmode="numeric">
        </div>
      </div>

      <div class="fab">
        <div class="left small" style="color:#ddd">入力データは端末内に保存（localStorage）。</div>
        <div class="right">
          <button class="ghost" id="btn-clear">クリア</button>
          <button class="primary" id="btn-save">保存</button>
        </div>
      </div>
      <div class="footer-space"></div>
    </section>

    <section id="view-preview" style="display:none">
      <div class="card">
        <div class="section-title">プレビュー</div>
        <div class="small muted">入力中の内容を集計して表示します。保存前の確認に使ってください。</div>
      </div>
      <div class="card">
        <div class="section-title">車両情報</div>
        <table>
          <tbody>
            <tr><th>ステーション</th><td id="pv-station"></td></tr>
            <tr><th>車種</th><td id="pv-model"></td></tr>
            <tr><th>車番</th><td id="pv-carno"></td></tr>
            <tr><th>解錠/施錠</th><td class="mono small" id="pv-unlocklock"></td></tr>
          </tbody>
        </table>
      </div>
      <div class="card">
        <div class="section-title">測定サマリー</div>
        <table>
          <thead>
            <tr>
              <th>位置</th>
              <th>残溝(mm)</th>
              <th>規定(kPa)</th>
              <th>調整前(kPa)</th>
              <th>調整後(kPa)</th>
              <th>差(後-規定)</th>
              <th>判定</th>
            </tr>
          </thead>
          <tbody id="pv-rows"></tbody>
        </table>
        <div class="small muted" style="margin-top:8px">
          判定ルール：残溝 <span class="danger">2.0</span> は危険、<span class="warn">3.0未満</span>は注意。圧力差 |後-規定| が <span class="warn">20kPa超</span> で注意。
        </div>
      </div>
      <div class="card">
        <div class="section-title">製造年週</div>
        <table>
          <thead><tr><th>RF</th><th>LF</th><th>LR</th><th>RR</th></tr></thead>
          <tbody><tr class="mono small"><td id="pv-yw-rf"></td><td id="pv-yw-lf"></td><td id="pv-yw-lr"></td><td id="pv-yw-rr"></td></tr></tbody>
        </table>
      </div>
      <div class="card">
        <div class="section-title">全体評価</div>
        <div id="pv-summary" class="small"></div>
      </div>
    </section>

    <section id="view-list" style="display:none">
      <div class="card">
        <div class="twocol">
          <div>
            <label class="small muted">絞り込み: ステーション</label>
            <input id="f-station" placeholder="含む文字で絞り込み">
          </div>
          <div>
            <label class="small muted">絞り込み: 車種</label>
            <input id="f-model" placeholder="含む文字で絞り込み" list="model-list">
          </div>
        </div>
        <div class="twocol" style="margin-top:10px">
          <div>
            <label class="small muted">絞り込み: 車番</label>
            <input id="f-carno" placeholder="含む文字で絞り込み">
          </div>
          <div class="actions" style="align-items:end;justify-content:flex-end">
            <button class="ghost" id="btn-clear-filter">フィルタ解除</button>
          </div>
        </div>
      </div>

      <div class="card">
        <table id="tbl">
          <thead>
            <tr>
              <th class="nowrap">日時</th>
              <th>ステーション</th>
              <th>車種</th>
              <th>車番</th>
              <th class="nowrap">解錠/施錠</th>
              <th class="nowrap">残溝 RF/LF/LR/RR</th>
              <th class="nowrap">規定圧 RF/LF/LR/RR</th>
              <th class="nowrap">調整前 RF/LF/LR/RR</th>
              <th class="nowrap">調整後 RF/LF/LR/RR</th>
              <th class="nowrap">製造年週 RF/LF/LR/RR</th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="view-spec" style="display:none">
      <div class="card">
        <div class="actions" style="justify-content:space-between">
          <div class="section-title">車種別 規定圧一覧</div>
          <div>
            <button class="ghost" id="btn-export-spec">CSV出力</button>
            <label class="ghost" style="border-radius:12px;padding:12px 14px;display:inline-block;cursor:pointer">
              CSV取込<input type="file" id="import-spec" accept=".csv" style="display:none">
            </label>
          </div>
        </div>
        <table id="tbl-spec">
          <thead><tr><th>車種</th><th>RF</th><th>LF</th><th>LR</th><th>RR</th><th></th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="view-tools" style="display:none">
      <div class="card">
        <div class="section-title">データ操作</div>
        <div class="actions">
          <button class="ghost" id="btn-export">CSV出力（全レコード）</button>
          <label class="ghost" style="border-radius:12px;padding:12px 14px;display:inline-block;cursor:pointer">
            CSV取込（レコード）<input type="file" id="import" accept=".csv" style="display:none">
          </label>
          <button class="ghost danger" id="btn-wipe">全データ削除</button>
        </div>
        <div class="small muted">CSVはUTF-8。レコードの重複は「日時＋車番」で上書きします。</div>
      </div>
    </section>

  </main>

<script>
/* 同上の長いJS（省略なしで収録済み） */
</script>
</body>
</html>
